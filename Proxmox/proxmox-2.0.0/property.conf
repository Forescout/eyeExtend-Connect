{
  "name": "proxmox",
  "groups": [
    {
      "name": "connect_proxmox_proxmox",
      "label": "Proxmox"
    },
    {
      "name": "connect_proxmox_pve_host",
      "label": "Proxmox PVE Host"
    }
  ],
  "properties": [
    {
      "tag": "connect_proxmox_vmid",
      "label": "Proxmox VM ID",
      "description": "Proxmox virtual machine or container ID",
      "type": "integer",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox VM ID"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_name",
      "label": "Proxmox Guest Hostname",
      "description": "Proxmox guest name",
      "type": "string",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox Guest Name"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_node",
      "label": "Proxmox Node",
      "description": "Proxmox cluster node hosting this guest",
      "type": "string",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox Node"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_status",
      "label": "Proxmox Status",
      "description": "Proxmox guest status",
      "type": "string",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "options": [
        {"name": "running", "label": "Running"},
        {"name": "stopped", "label": "Stopped"},
        {"name": "paused", "label": "Paused"},
        {"name": "suspended", "label": "Suspended"}
      ],
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox Status"
      },
      "track_change": {
        "enable": true,
        "label": "Proxmox Status Changed",
        "description": "Track when Proxmox guest status changes"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_type",
      "label": "Proxmox Guest Type",
      "description": "Proxmox guest type (VM or Container)",
      "type": "string",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "options": [
        {"name": "qemu", "label": "VM (QEMU)"},
        {"name": "lxc", "label": "Container (LXC)"}
      ],
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox Guest Type"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_os_type",
      "label": "Proxmox OS Type",
      "description": "Proxmox OS type from configuration",
      "type": "string",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox OS Type"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_guest_os",
      "label": "Proxmox Guest OS",
      "description": "Detailed guest operating system from QEMU guest agent",
      "type": "string",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox Guest OS"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_cpu_cores",
      "label": "Proxmox CPU Cores",
      "description": "Number of CPU cores allocated",
      "type": "integer",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox CPU Cores"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_memory_mb",
      "label": "Proxmox Guest Memory (MB)",
      "description": "Maximum memory allocated in megabytes",
      "type": "integer",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox Memory"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_disk_gb",
      "label": "Proxmox Guest Disk Size (GB)",
      "description": "Maximum disk size in gigabytes",
      "type": "integer",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox Disk"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_uptime",
      "label": "Proxmox Uptime (seconds)",
      "description": "Guest uptime in seconds",
      "type": "integer",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_tags",
      "label": "Proxmox Tags",
      "description": "Proxmox guest tags",
      "type": "string",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox Tags"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_template",
      "label": "Proxmox Template",
      "description": "Whether this guest is a Proxmox template",
      "type": "boolean",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_description",
      "label": "Proxmox Description",
      "description": "Proxmox guest description",
      "type": "string",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_guest_agent",
      "label": "Proxmox QEMU Guest Agent Installed",
      "description": "Whether the QEMU guest agent is installed and responding",
      "type": "boolean",
      "group": "connect_proxmox_proxmox",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_hostname",
      "label": "Proxmox PVE Hostname",
      "description": "PVE node hostname",
      "type": "string",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE Hostname"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_status",
      "label": "Proxmox PVE Status",
      "description": "PVE node status",
      "type": "string",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "options": [
        {"name": "online", "label": "Online"},
        {"name": "offline", "label": "Offline"},
        {"name": "unknown", "label": "Unknown"}
      ],
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE Status"
      },
      "track_change": {
        "enable": true,
        "label": "PVE Node Status Changed",
        "description": "Track when PVE node status changes"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_cpu_model",
      "label": "Proxmox PVE CPU Model",
      "description": "PVE node CPU model name",
      "type": "string",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE CPU Model"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_cpu_cores",
      "label": "Proxmox PVE CPU Cores",
      "description": "Total CPU cores on PVE node",
      "type": "integer",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE CPU Cores"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_cpu_sockets",
      "label": "Proxmox PVE CPU Sockets",
      "description": "Number of CPU sockets on PVE node",
      "type": "integer",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE CPU Sockets"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_memory_gb",
      "label": "Proxmox PVE Total Memory (GB)",
      "description": "Total memory on PVE node in gigabytes",
      "type": "integer",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE Total Memory"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_disk_gb",
      "label": "Proxmox PVE Root Disk (GB)",
      "description": "Root filesystem size on PVE node in gigabytes",
      "type": "integer",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE Root Disk"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_kernel",
      "label": "Proxmox PVE Kernel Version",
      "description": "Linux kernel version on PVE node",
      "type": "string",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE Kernel Version"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_version",
      "label": "Proxmox PVE Version",
      "description": "Proxmox VE software version",
      "type": "string",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Proxmox PVE Version"
      },
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_uptime",
      "label": "Proxmox PVE Uptime (seconds)",
      "description": "PVE node uptime in seconds",
      "type": "integer",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "tag": "connect_proxmox_pve_updates_available",
      "label": "Proxmox PVE Updates Available",
      "description": "Whether package updates are pending on the PVE node",
      "type": "boolean",
      "group": "connect_proxmox_pve_host",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "web_enable": true,
      "dependencies": [
        {"name": "mac", "redo_new": true, "redo_change": true},
        {"name": "ip", "redo_new": true, "redo_change": true}
      ]
    }
  ],
  "action_groups": [
    {
      "name": "connect_proxmox_actions",
      "label": "Proxmox"
    }
  ],
  "actions": [
    {
      "name": "connect_proxmox_start",
      "label": "Start VM/Container",
      "group": "connect_proxmox_actions",
      "description": "Start a stopped Proxmox VM or LXC container",
      "ip_required": false,
      "dependencies": [
        {"name": "connect_proxmox_vmid", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_node", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_type", "redo_new": true, "redo_change": true}
      ],
      "undo": {
        "label": "Stop VM/Container",
        "description": "Stop the VM/Container that was started"
      }
    },
    {
      "name": "connect_proxmox_stop",
      "label": "Stop VM/Container",
      "group": "connect_proxmox_actions",
      "description": "Force stop a running Proxmox VM or LXC container (immediate power off)",
      "ip_required": false,
      "dependencies": [
        {"name": "connect_proxmox_vmid", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_node", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_type", "redo_new": true, "redo_change": true}
      ],
      "undo": {
        "label": "Start VM/Container",
        "description": "Start the VM/Container that was stopped"
      }
    },
    {
      "name": "connect_proxmox_shutdown",
      "label": "Shutdown VM/Container",
      "group": "connect_proxmox_actions",
      "description": "Gracefully shut down a Proxmox VM or LXC container via ACPI signal",
      "ip_required": false,
      "dependencies": [
        {"name": "connect_proxmox_vmid", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_node", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_type", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "name": "connect_proxmox_reboot",
      "label": "Reboot VM/Container",
      "group": "connect_proxmox_actions",
      "description": "Gracefully reboot a Proxmox VM or LXC container",
      "ip_required": false,
      "dependencies": [
        {"name": "connect_proxmox_vmid", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_node", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_type", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "name": "connect_proxmox_suspend",
      "label": "Suspend VM",
      "group": "connect_proxmox_actions",
      "description": "Suspend a running QEMU VM (pauses execution, preserves state). QEMU VMs only.",
      "ip_required": false,
      "dependencies": [
        {"name": "connect_proxmox_vmid", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_node", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_type", "redo_new": true, "redo_change": true}
      ],
      "undo": {
        "label": "Resume VM",
        "description": "Resume the VM that was suspended"
      }
    },
    {
      "name": "connect_proxmox_resume",
      "label": "Resume VM",
      "group": "connect_proxmox_actions",
      "description": "Resume a suspended QEMU VM. QEMU VMs only.",
      "ip_required": false,
      "dependencies": [
        {"name": "connect_proxmox_vmid", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_node", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_type", "redo_new": true, "redo_change": true}
      ],
      "undo": {
        "label": "Suspend VM",
        "description": "Suspend the VM that was resumed"
      }
    },
    {
      "name": "connect_proxmox_snapshot",
      "label": "Create Snapshot",
      "group": "connect_proxmox_actions",
      "description": "Create a point-in-time snapshot of a VM or LXC container",
      "ip_required": false,
      "params": [
        {
          "name": "connect_proxmox_snapshot_name",
          "type": "string",
          "label": "Snapshot Name",
          "description": "Name for the snapshot (alphanumeric, no spaces)"
        },
        {
          "name": "connect_proxmox_snapshot_description",
          "type": "string",
          "label": "Description",
          "description": "Optional description for the snapshot"
        }
      ],
      "dependencies": [
        {"name": "connect_proxmox_vmid", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_node", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_type", "redo_new": true, "redo_change": true}
      ]
    },
    {
      "name": "connect_proxmox_set_tags",
      "label": "Set Tags",
      "group": "connect_proxmox_actions",
      "description": "Set tags on a VM or LXC container (replaces all existing tags)",
      "ip_required": false,
      "params": [
        {
          "name": "connect_proxmox_new_tags",
          "type": "string",
          "label": "Tags",
          "description": "Semicolon-separated tags to set (e.g. quarantined;non-compliant)"
        }
      ],
      "dependencies": [
        {"name": "connect_proxmox_vmid", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_node", "redo_new": true, "redo_change": true},
        {"name": "connect_proxmox_type", "redo_new": true, "redo_change": true}
      ],
      "undo": {
        "label": "Restore Previous Tags",
        "description": "Restore the tags that were set before the action"
      }
    }
  ],
  "scripts": [
    {
      "name": "proxmox_test.py",
      "test": true
    },
    {
      "name": "proxmox_poll.py",
      "discovery": true
    },
    {
      "name": "proxmox_resolve.py",
      "properties": [
        "connect_proxmox_vmid",
        "connect_proxmox_name",
        "connect_proxmox_node",
        "connect_proxmox_status",
        "connect_proxmox_type",
        "connect_proxmox_os_type",
        "connect_proxmox_guest_os",
        "connect_proxmox_cpu_cores",
        "connect_proxmox_memory_mb",
        "connect_proxmox_disk_gb",
        "connect_proxmox_uptime",
        "connect_proxmox_tags",
        "connect_proxmox_template",
        "connect_proxmox_description",
        "connect_proxmox_guest_agent"
      ]
    },
    {
      "name": "proxmox_resolve_node.py",
      "properties": [
        "connect_proxmox_pve_hostname",
        "connect_proxmox_pve_status",
        "connect_proxmox_pve_cpu_model",
        "connect_proxmox_pve_cpu_cores",
        "connect_proxmox_pve_cpu_sockets",
        "connect_proxmox_pve_memory_gb",
        "connect_proxmox_pve_disk_gb",
        "connect_proxmox_pve_kernel",
        "connect_proxmox_pve_version",
        "connect_proxmox_pve_uptime",
        "connect_proxmox_pve_updates_available"
      ]
    },
    {
      "name": "proxmox_start.py",
      "actions": ["connect_proxmox_start"]
    },
    {
      "name": "proxmox_start_cancel.py",
      "is_cancel": true,
      "actions": ["connect_proxmox_start"]
    },
    {
      "name": "proxmox_stop.py",
      "actions": ["connect_proxmox_stop"]
    },
    {
      "name": "proxmox_stop_cancel.py",
      "is_cancel": true,
      "actions": ["connect_proxmox_stop"]
    },
    {
      "name": "proxmox_shutdown.py",
      "actions": ["connect_proxmox_shutdown"]
    },
    {
      "name": "proxmox_reboot.py",
      "actions": ["connect_proxmox_reboot"]
    },
    {
      "name": "proxmox_suspend.py",
      "actions": ["connect_proxmox_suspend"]
    },
    {
      "name": "proxmox_suspend_cancel.py",
      "is_cancel": true,
      "actions": ["connect_proxmox_suspend"]
    },
    {
      "name": "proxmox_resume.py",
      "actions": ["connect_proxmox_resume"]
    },
    {
      "name": "proxmox_resume_cancel.py",
      "is_cancel": true,
      "actions": ["connect_proxmox_resume"]
    },
    {
      "name": "proxmox_snapshot.py",
      "actions": ["connect_proxmox_snapshot"]
    },
    {
      "name": "proxmox_set_tags.py",
      "actions": ["connect_proxmox_set_tags"]
    },
    {
      "name": "proxmox_set_tags_cancel.py",
      "is_cancel": true,
      "actions": ["connect_proxmox_set_tags"]
    },
    {
      "name": "proxmox_lib.py",
      "library_file": true
    }
  ],
  "policy_template": {
    "policy_template_group": {
      "name": "connect_proxmox",
      "label": "Proxmox",
      "display": "Proxmox",
      "description": "Proxmox templates",
      "full_description": "<html>Templates for Proxmox VE integration.</html>",
      "title_image": "connect_proxmox.png"
    },
    "policies": []
  }
}
