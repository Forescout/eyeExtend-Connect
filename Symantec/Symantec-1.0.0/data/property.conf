{
  "name": "Symantec",
  "groups": [
    {
      "name":"connect_symantec_symantec",
      "label":"Symantec"
    }
  ],
  "properties": [
    {
      "tag": "connect_symantec_group_id",
      "label": "Symantec Group ID",
      "description": "Symantec Group ID",
      "type": "string",
      "group": "connect_symantec_symantec",
      "resolvable": true,
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_computer_id",
      "label": "Symantec Computer ID",
      "description": "Symantec Computer ID",
      "type": "string",
      "group": "connect_symantec_symantec",
      "resolvable": true,
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_computer_name",
      "label": "Symantec Computer Name",
      "description": "Symantec Computer Name",
      "type": "string",
      "group": "connect_symantec_symantec",
      "resolvable": true,
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_mac_address",
      "label": "Symantec Mac Address",
      "description": "Symantec Mac Address",
      "type": "string",
      "group": "connect_symantec_symantec",
      "resolvable": true,
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_ip_address",
      "label": "Symantec IP Address",
      "description": "Symantec IP Address",
      "type": "string",
      "group": "connect_symantec_symantec",
      "resolvable": true,
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_os",
      "label": "Symantec Operating System",
      "description": "Symantec Operating System",
      "type": "string",
      "group": "connect_symantec_symantec",
      "resolvable": true,
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_auto_protection_status",
      "label": "Symantec Auto-Protection Status",
      "description": "Symantec Auto-Protection Status",
      "type": "string",
      "options":[
        {
            "name": "off",
            "label": "Off"
        },
        {
            "name": "on",
            "label": "On"
        },
        {
            "name": "not installed",
            "label": "Not Installed"
        },
        {
            "name": "status not reported",
            "label": "Status Not Reported"
        }
      ],
      "group": "connect_symantec_symantec",
      "resolvable": true,
      "track_change":
      {
        "enable": true,
        "label":"Connect Symantec Auto-Protection Status Change",
        "description":"Indicates whether there's been a change to the Auto-Protection status."
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_antivirus_def_date",
      "label": "Symantec Anti-virus Definition Date",
      "description": "Symantec Anti-virus Definition Date",
      "type": "date",
      "resolvable": true,
      "group": "connect_symantec_symantec",
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_host_integrity_status",
      "label": "Symantec Host Integrity Status",
      "description": "Symantec Host Integrity Status",
      "type": "string",
      "options":[
        {
            "name": "fail",
            "label": "Fail"
        },
        {
            "name": "success",
            "label": "Success"
        },
        {
            "name": "pending",
            "label": "Pending"
        },
        {
            "name": "disabled",
            "label": "Disabled"
        },
        {
            "name": "ignore",
            "label": "Ignore"
        }
      ],
      "resolvable": true,
      "group": "connect_symantec_symantec",
      "track_change":
      {
        "enable": true,
        "label":"Connect Symantec Host Integrity Status Change",
        "description":"Indicates a change to the host integrity status on the endpoint."
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_host_infected",
      "label": "Symantec Host Infected",
      "description": "Symantec Host Infected",
      "type": "boolean",
      "resolvable": true,
      "group": "connect_symantec_symantec",
      "track_change":
      {
        "enable": true,
        "label":"Connect Symantec Host Infected Status Change",
        "description":"Indicates a change to the infection state of an endpoint."
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_host_managed",
      "label": "Symantec Host Managed",
      "description": "Symantec Host Managed",
      "type": "boolean",
      "resolvable": true,
      "group": "connect_symantec_symantec",
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_ips_status",
      "label": "Symantec IPS Status",
      "description": "Symantec IPS Status",
      "type": "string",
      "options":[
        {
            "name": "off",
            "label": "Off"
        },
        {
            "name": "on",
            "label": "On"
        },
        {
            "name": "not installed",
            "label": "Not Installed"
        },
        {
            "name": "off by admin policy",
            "label": "Off by Admin Policy"
        },
        {
            "name": "unknown",
            "label": "Unknown"
        }
      ],
      "group": "connect_symantec_symantec",
      "track_change":
      {
        "enable": true,
        "label":"Connect Symantec Intrusion Prevention System Status Change",
        "description":"Indicates whether there has been a change to the status of the Symantec IPS on the endpoint."
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
     {
       "tag": "connect_symantec_last_sync_time",
       "label": "Symantec Last Synchronization Time",
       "description": "Symantec Last Synchronization Time",
       "type": "date",
       "resolvable": true,
       "group": "connect_symantec_symantec",
       "dependencies": [
         {
           "name": "mac",
           "redo_new": true,
           "redo_change": true
         }
       ]
     },
    {
      "tag": "connect_symantec_ntp_enabled",
      "label": "Symantec Network Threat Protection Enabled",
      "description": "Symantec Network Threat Protection Enabled",
      "type": "boolean",
      "resolvable": true,
      "group": "connect_symantec_symantec",
      "track_change":
      {
        "enable": true,
        "label":"Connect Symantec Network Threat Protection Status Change",
        "description":"Indicates whether there has been a change to the endpoint's Symantec Threat Protection status."
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_sonar_status",
      "label": "Symantec SONAR Status",
      "description": "Symantec SONAR Status",
      "type": "string",
      "options":[
        {
            "name": "off",
            "label": "Off"
        },
        {
            "name": "on",
            "label": "On"
        },
        {
            "name": "not installed",
            "label": "Not Installed"
        },
        {
            "name": "off by policy",
            "label": "Off by Policy"
        },
        {
            "name": "malfunction",
            "label": "Malfunction"
        }
      ],
      "resolvable": true,
      "group": "connect_symantec_symantec",
      "track_change":
      {
        "enable": true,
        "label":"Connect Symantec SONAR Status Change",
        "description":"Indicates whether there has been a change to the Symantec Online Network for Advanced Response's (SONAR) status on the endpoint."
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_symantec_infection_info",
      "label": "Symantec Infection Information",
      "description": "Symantec Infection Information",
      "type": "composite",
      "group": "connect_symantec_symantec",
      "resolvable": false,
      "subfields": [
        {
          "tag": "name",
          "label": "Infection Name",
          "description": "Infection Name",
          "type": "string"
        },
        {
          "tag": "date",
          "label": "Infection Time",
          "description": "Infection Time",
          "type": "date"
        },
        {
          "tag": "file_name",
          "label": "File Name",
          "description": "Infection File Name",
          "type": "string"
        },
        {
          "tag": "hash",
          "label": "Infection Hash",
          "description": "Infection Hash",
          "type": "string"
        },
        {
          "tag": "hash_type",
          "label": "Infection Hash Type",
          "description": "Infection Hash Type",
          "type": "string"
        },
        {
          "tag": "severity",
          "label": "Infection Severity",
          "description": "Infection Severity",
          "type": "string",
          "options":[
            {
              "name": "critical",
              "label": "Critical"
            },
            {
              "name": "high",
              "label": "High"
            },
            {
              "name": "medium",
              "label": "Medium"
            },
            {
              "name": "low",
              "label": "Low"
            },
            {
              "name": "none",
              "label": "None"
            }
          ]
        }
      ],
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    }
  ],
  "action_groups": [
    {
      "name":"connect_symantec_symantec",
      "label":"Symantec"
    }
  ],
  "actions": [
    {
      "name": "connect_symantec_scan_endpoint",
      "label": "Scan Endpoint",
      "group": "connect_symantec_symantec",
      "description": "Scan Endpoint",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "symantec_scan_mode",
          "label": "Scan Mode",
          "description": "Scan Mode",
          "type": "list",
          "options": [
            {
               "name": "activescan",
               "label": "Active Scan"
            },
            {
               "name": "fullscan",
               "label": "Full Scan"
            }
          ]
        }
      ]
    },
    {
      "name": "connect_symantec_update_endpoint",
      "label": "Update Endpoint",
      "group": "connect_symantec_symantec",
      "description": "Update Endpoint",
      "ip_required": false,
      "threshold_percentage": 1,
      "dependencies": [
         {
           "name": "connect_symantec_computer_id",
           "redo_new": true,
           "redo_change": true
         },
         {
           "name": "connect_symantec_group_id",
           "redo_new": true,
           "redo_change": true
         }
      ]
    }
  ],
  "scripts": [
    {
      "name": "symantec_resolve.py",
      "properties": [
        "connect_symantec_group_id",
        "connect_symantec_computer_id",
        "connect_symantec_computer_name",
        "connect_symantec_os",
        "connect_symantec_auto_protection_status",
        "connect_symantec_host_integrity_status",
        "connect_symantec_host_infected",
		"connect_symantec_host_managed",
        "connect_symantec_ips_status",
        "connect_symantec_last_sync_time",
        "connect_symantec_ntp_enabled",
        "connect_symantec_sonar_status"
      ]
    },
    {
      "name": "symantec_authorization.py",
      "authorization": true
    },
    {
      "name": "symantec_test.py",
      "test": true
    },
    {
      "name": "symantec_poll.py",
      "discovery": true
    },
	{
	  "name":"symantec_parse_syslog_message.py",
	  "syslog_message":true
    },
	{
	  "name":"symantec_scan_endpoint.py",
	  "is_cancel": false,
	  "actions":[
	    "connect_symantec_scan_endpoint"
	  ]
    },
	{
	  "name":"symantec_update_endpoint.py",
	  "is_cancel": false,
	  "actions":[
	    "connect_symantec_update_endpoint"
	  ]
    }
  ],
  "policy_template": {
    "policy_template_group": {
       "name": "connect_symantec",
       "label": "Symantec",
       "display": "Symantec",
       "description": "Symantec templates",
       "full_description": "Use Symantec policy templates to manage devices in a Symantec environment",
       "title_image": "connect_symantec.png"
    },
    "policies": [
      {
        "name": "connect_symantec_av_compliance",
        "label": "Symantec Anti-Virus Compliance",
        "display": "Symantec Anti-Virus Compliance",
        "help": "Symantec Anti-Virus Compliance Policy",
        "description": "Creates Symantec Anti-Virus Compliance Policy",
        "file_name": "AntiVirusCompliance.xml",
        "full_description": "<html>The Anti-Virus Compliance policy indicates which endpoints have the Symantec Agent installed and running, and the anti-virus component (Auto-Protect) enabled. <br> If the endpoint is non-compliant, a series of actions (in the form of sub-rules) take place and Symantec reports the results to CounterACT.</html>",
        "title_image": "connect_symantec.png"
      },
      {
        "name": "connect_symantec_hi_compliance",
        "label": "Symantec Host Integrity Compliance",
        "display": "Symantec Host Integrity Compliance",
        "help": "Symantec Host Integrity Compliance Policy",
        "description": "Creates Symantec Host Integrity Compliance Policy",
        "file_name": "HostIntegrityCompliance.xml",
        "full_description": "<html>Use this template to create a CounterACT policy that takes the information from Symantec into CounterACT and allows the CounterACT operator to make compliance decisions based on it. <br> Then, based on that compliance information, the CounterACT operator may attempt to remediate or quarantine non-compliant endpoints. Actions (in the form of Sub-rules) are executed and Symantec reports to CounterACT the results of these actions as Fail, Success, Pending, Disabled, or Ignore.</html>",
        "title_image": "connect_symantec.png"
      },
      {
        "name": "connect_symantec_ips_compliance",
        "label": "Symantec Intrusion Protection Compliance",
        "display": "Symantec Intrusion Protection Compliance",
        "help": "Symantec Intrusion Protection Compliance Policy",
        "description": "Creates Symantec Intrusion Compliance Policy",
        "file_name": "IntrusionProtectionCompliance.xml",
        "full_description": "<html>Use this template to create a CounterACT policy that takes the status of the IPS configuration from Symantec and transforms it into Compliance information in CounterACT. <br> If the endpoint is non-compliant, a series of actions (in the form of sub-rules) take place and Symantec reports the results to CounterACT. <br>  Note - You must enable the IPS feature in order for this template to be effective.",
        "title_image": "connect_symantec.png"
      },
      {
        "name": "connect_symantec_ntp_compliance",
        "label": "Symantec Network Threat Protection Compliance",
        "display": "Symantec Network Threat Protection Compliance",
        "help": "Symantec Network Threat Protection Compliance Policy",
        "description": "Creates Symantec Network Threat Protection Compliance Policy",
        "file_name": "NetworkThreatProtectionCompliance.xml",
        "full_description": "<html>Use this template to categorize endpoints based on whether the CounterACT operators have this Symantec feature enabled. If the endpoint is non-compliant, a series of actions (in the form of sub-rules) take place and Symantec reports the results to CounterACT.<br> Use this template to create a CounterACT policy that takes action when an endpoint is not compliant due to a NTP-related issue.</html>",
        "title_image": "connect_symantec.png"
      },
      {
        "name": "connect_symantec_sonar_compliance",
        "label": "Symantec Online Network for Advanced Response Compliance",
        "display": "Symantec Online Network for Advanced Response Compliance",
        "help": "Symantec Online Network for Advanced Response Compliance Policy",
        "description": "Creates Symantec Online Network for Advanced Response Compliance policies",
        "file_name": "SONARCompliance.xml",
        "full_description": "<html>Use this template to create a CounterACT policy that takes action when the endpoint is not compliant due to the status of the SONAR component of the endpoint. Symantec returns the results to CounterACT with the following values: On, Off, Not Installed, Off by Policy or Malfunction.<br>  Note - You must enable the SONAR feature in order for this template to be effective.</html>",
        "title_image": "connect_symantec.png"
      },
      {
        "name": "connect_symantec_host_infected",
        "label": "Symantec Host Infected",
        "display": "Symantec Host Infected",
        "help": "Symantec Host Infected",
        "description": "Symantec Host Infected",
        "file_name": "HostInfected.xml",
        "full_description": "<html>Use this template to create a CounterACT policy that detects whether an endpoint is infected or not. If Symantec finds an infected endpoint, based upon the severity of the endpoint's infection, the Host Infected policy instructs what actions to take. An example action would be to quarantine the infected endpoint from the network.</html>",
        "title_image": "connect_symantec.png"
      },
      {
        "name": "connect_symantec_scan_ioc_alert",
        "label": "Scan on IOC Alert",
        "display": "Scan on IOC Alert",
        "help": "Scan on IOC Alert",
        "description": "Scan on IOC Alert",
        "file_name": "ScanOnIocAlert.xml",
        "full_description": "<html>Use this template to create a CounterACT policy that waits for reports of IOCs/malware from other integrated engines via the Advanced Threat Detection integrations of CounterACT. That threat report is ingested, and triggers a scan on Symantec-managed endpoints based on the severity of the recently-received IOC report. Depending upon the settings in the Scan on IOC Alert policy, a quick or full scan on the endpoint occurs.</html>",
        "title_image": "connect_symantec.png"
      }
    ]
  }
}
