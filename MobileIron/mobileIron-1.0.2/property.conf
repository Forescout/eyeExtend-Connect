{
  "name": "MobileIronMDM",
  "groups": [
    {
      "name":"connect_mobileironmdm_core_attributes",
      "label":"MobileIron Details"
    },
    {
      "name":"connect_mobileironmdm_client_apps",
      "label":"MobileIron Apps"
    }
  ],
  "properties": [
	  {
      "tag": "connect_mobileironmdm_device_uid",
      "label": "MobileIron Device ID",
      "description": "Device Unique Identifier",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_mac_address",
      "label": "MobileIron Device MAC Address",
      "description": "MobileIron Device MAC Address",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_manufacturer",
      "label": "MobileIron Device Manufacturer",
      "description": "Device Manufacturer",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_model",
      "label": "MobileIron Device Model",
      "description": "Device model",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_os",
      "label": "MobileIron Operating System",
      "description": "Device Platform/OS",
      "type": "string",
      "options": [
        {
          "name": "ANDROID",
          "label": "Android"
        },
        {
          "name": "IOS",
          "label": "iOS"
        }
      ],
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_os_version",
      "label": "MobileIron Device OS Version",
      "description": "Device OS Version",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_ios_device_jailbroken",
      "label": "MobileIron iOS Device Jailbroken",
      "description": "iOS Device Jailbroken",
      "type": "boolean",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_android_device_rooted",
      "label": "MobileIron Android Device Rooted",
      "description": "Android Device Rooted",
      "type": "boolean",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_phone_number",
      "label": "MobileIron Device Phone Number",
      "description": "Device Phone Number",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_serial_number",
      "label": "MobileIron Device Serial Number",
      "description": "Device Serial Number",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    }, 
    {
      "tag": "connect_mobileironmdm_user_id",
      "label": "MobileIron User Name",
      "description": "User Name",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },     
    {
      "tag": "connect_mobileironmdm_user_uuid",
      "label": "MobileIron User UID",
      "description": "Device User Unique ID",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_ownership",
      "label": "MobileIron Device Ownership E/C",
      "description": "Device Ownership (Employee/Company)",
      "type": "string",
      "options": [
        {
          "name": "EMPLOYEE",
          "label": "Employee"
        },
        {
          "name": "COMPANY",
          "label": "Company"
        },
        {
          "name": "UNKNOWN",
          "label": "Unknown"
        }
      ],
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },     
    {
      "tag": "connect_mobileironmdm_compromised",
      "label": "MobileIron Compromised Device",
      "description": "Compromised Device",
      "type": "boolean",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_mdm_managed",
      "label": "MobileIron MDM Managed Device",
      "description": "Indicates whether device is managed by the MobileIron server",
      "type": "boolean",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_blocked",
      "label": "MobileIron Blocked Device",
      "description": "Blocked Device",
      "type": "boolean",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_quarantined",
      "label": "MobileIron Quarantined Device",
      "description": "Quarantined Device",
      "type": "boolean",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    }, 
    {
      "tag": "connect_mobileironmdm_compliance_state",
      "label": "MobileIron Device Compliance State",
      "description": "Compliance State",
      "type": "string",
      "options": [
        {
          "name": "true",
          "label": "Compliant"
        },
        {
          "name": "false",
          "label": "Not Compliant"
        }
      ],
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_status",
      "label": "MobileIron Device Status",
      "description": "Indicates the device status - whether active, retired, enrollment-pending, etc.",
      "type": "string",
      "options": [
        {
          "name": "ACTIVE",
          "label": "Active"
        },
        {
          "name": "RETIRED",
          "label": "Retired"
        },
        {
          "name": "WIPED",
          "label": "Wiped"
        },
        {
          "name": "ENROLLMENT_PENDING",
          "label": "Enrollment Pending"
        }
      ],
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_last_check_in_time",
      "label": "MobileIron Device Last Check-In",
      "description": "Device Last Check-in",
      "type": "date",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_registration_time",
      "label": "MobileIron Device Registration Time",
      "description": "Device Registration Time",
      "type": "date",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    }, 
    {
      "tag": "connect_mobileironmdm_imei",
      "label": "MobileIron Device IMEI",
      "description": "Device IMEI",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    }, 
    {
      "tag": "connect_mobileironmdm_imsi",
      "label": "MobileIron Device IMSI",
      "description": "Device IMSI",
      "type": "string",
      "group": "connect_mobileironmdm_core_attributes",
      "require_host_access": false,
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    },
    {
      "tag": "connect_mobileironmdm_client_apps",
      "label": "MobileIron Apps",
      "description": "MobileIron Client Applications",
      "type": "composite",
      "list": true,
      "group": "connect_mobileironmdm_client_apps",
      "require_host_access": false,
      "inventory": {
        "enable": true,
        "description": "MobileIron Real-time Inventory of Software Applications installed"
      },
      "overwrite": true,
      "subfields": [
        {
          "tag": "connect_mobileironmdm_app_id",
          "label": "MobileIron App Name ID",
          "description": "MobileIron Application ID",
          "type": "string",
          "inventory": true
        },
        {
          "tag": "connect_mobileironmdm_app_name",
          "label": "MobileIron Reported App Name",
          "description": "MobileIron Reported Application Name",
          "type": "string",
          "inventory": true
        },
        {
          "tag": "connect_mobileironmdm_app_managed",
          "label": "MobileIron Managed App",
          "description": "MobileIron Managed Application",
          "type": "boolean"
        },
        {
          "tag": "connect_mobileironmdm_app_version",
          "label": "MobileIron App Version",
          "description": "MobileIron Application Version",
          "type": "string",
          "inventory": true
        }
      ],
      "dependencies": [
        {
          "name": "mac"
        },
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    }
	
  ],

  "action_groups": [
    {
      "name": "connect_mobileironmdm_mobileironmdm",
      "label": "MobileIron"
    }
  ],
  
  "actions": [
    {
      "name": "connect_mobileironmdm_device_force_checkin",
      "label": "MobileIron Force Device Check-in",
      "group": "connect_mobileironmdm_mobileironmdm",
      "description": "Force the device to connect to the MobileIron Core. Use this feature if the MobileIron Client has been disconnected from the server for an extended period.",
      "ip_required": false,
      "threshold_percentage": 1,
      "dependencies": [
        {
          "name": "connect_mobileironmdm_device_uid"
        }
      ]
    }
  ],
  
  "scripts": [
    {
      "name": "mobileironmdm_resolve.py",
      "properties": [
        "connect_mobileironmdm_device_uid",
        "connect_mobileironmdm_mac_address",
        "connect_mobileironmdm_manufacturer",
        "connect_mobileironmdm_model",
        "connect_mobileironmdm_os",
        "connect_mobileironmdm_android_device_rooted",
        "connect_mobileironmdm_ios_device_jailbroken",
        "connect_mobileironmdm_compliance_state",
        "connect_mobileironmdm_mdm_managed",
        "connect_mobileironmdm_quarantined",
        "connect_mobileironmdm_blocked",
        "connect_mobileironmdm_compromised",
        "connect_mobileironmdm_status",
        "connect_mobileironmdm_last_check_in_time",
        "connect_mobileironmdm_registration_time",
        "connect_mobileironmdm_imei",
        "connect_mobileironmdm_imsi",
        "connect_mobileironmdm_os_version",
        "connect_mobileironmdm_phone_number",
        "connect_mobileironmdm_serial_number",
        "connect_mobileironmdm_user_id",
        "connect_mobileironmdm_user_uuid",
        "connect_mobileironmdm_ownership"
      ]
    },

    {
      "name": "mobileironmdm_resolve_app_inventory.py",
      "properties": [
        "connect_mobileironmdm_client_apps"
      ]
    },
    
    {
      "name": "mobileironmdm_poll.py",
      "discovery": true
    },

    {
      "name": "mobileironmdm_force_checkin_action.py",
      "actions": [
        "connect_mobileironmdm_device_force_checkin"
      ]
    },

  	{
        "name": "mobileironmdm_test.py",
        "test": true
  	}
  ],

  "policy_template": {

    "policy_template_group": {
      "name": "connect_mobileironmdm",
      "label": "MobileIron",
      "display": "MobileIron",
      "description": "MobileIron templates",
      "full_description": "\u003chtml\u003eUse MobileIronMDM policy templates to detect, manage and remediate mobile devices in a MobileIron environment:\u003cul\u003e\u003cli\u003eDetect devices that have not enrolled with the MobileIronMDM service and prompt users to enroll.\u003c/li\u003e\u003cli\u003eDetect non-compliant devices.\u003c/li\u003e\u003cli\u003eDetect offsite devices.\u003c/li\u003e\u003c/ul\u003e\u003c/html\u003e",
      "title_image": "connect_mobileironmdm.png"
    },

    "policies": [
      {
        "name": "connect_mobileironmdm_mdm_classification",
        "label": "Enrollment Step 1: MDM Classification",
        "display": "Enrollment Step 1: MDM Classification",
        "help": "MDM Classification (Enrollment Step 1)",
        "description": "Creates MobileIron manageability policies",
        "file_name": "MDMClassification.xml",
        "full_description": "\u003chtml\u003eOnly \u003cb\u003eMobile devices\u003c/b\u003e group members should be included in the policy you are creating",
        "title_image": "connect_mobileironmdm.png"
      },
      {
        "name": "connect_mobileironmdm_enrollment",
        "label": "Enrollment Step 2: MobileIron Device Enrollment",
        "display": "Enrollment Step 2: MobileIron Device Enrollment",
        "help": "MobileIron Device Enrollment (Enrollment Step 2)",
        "description": "Creates MobileIronMDM Device Enrollment policies",
        "file_name": "MobileIronDeviceEnrollment.xml",
        "full_description": "\u003chtml\u003eUse this policy template to detect corporate hosts not enrolled with the MobileIron service, and prompt host users to enroll.\u003cbr\u003eCorporate hosts are defined as hosts that have authenticated via the HTTP Login action or have enrolled through Company Portal on their device.\u003cbr\u003eBy default, users cannot browse the Internet until enrollment is complete.\u003cbr\u003eA restrictive action blocks corporate network access to users not enrolled.\u003cbr\u003eThis action is disabled by default.\u003cbr\u003e\u003c/html\u003e",
        "title_image": "connect_mobileironmdm.png"
      },
      {
        "name": "connect_mobileironmdm_device_compliance",
        "label": "MobileIron Device Compliance",
        "display": "MobileIron Device Compliance",
        "help": "MobileIron MDM Device Compliance",
        "description": "Creates MobileIronMDM Device Compliance policies",
        "file_name": "MobileIronDeviceCompliance.xml",
        "full_description": "\u003chtml\u003e.Use this policy template to detect non-compliant devices and redirect non-compliant users to a notification message\u003c/html\u003e",
        "title_image": "connect_mobileironmdm.png"
      }
    ]
  }

}
  