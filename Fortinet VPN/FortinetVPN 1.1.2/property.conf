{
    "name": "fvpn",
    "groups": [
        {
            "name": "connect_fvpn_fvpn",
            "label": "Fortinet VPN"
        }
    ],
    "properties": [
        {
            "tag": "connect_fvpn_ip",
            "label": "Fortigate IP",
            "description": "Fortinet IP",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_serial",
            "label": "Fortigate Serial Number",
            "description": "Fortigate Serial",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_learnt",
            "label": "Device learnt from",
            "description": "Device learnt from",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_hostname",
            "label": "Fortigate Hostname",
            "description": "Fortigate Hostname",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_vdom",
            "label": "Fortigate VDOM",
            "description": "Fortigate VDOM",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_version",
            "label": "Fortigate Version",
            "description": "Fortigate Version",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_user",
            "label": "Fortinet VPN User",
            "description": "Fortinet VPN User",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_type",
            "label": "Fortinet VPN Type",
            "description": "Fortinet VPN Type",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_p1name",
            "label": "Fortinet VPN IPSEC p1name",
            "description": "Fortinet VPN IPSEC p1name",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_p2name",
            "label": "Fortinet VPN IPSEC p2name",
            "description": "Fortinet VPN IPSEC p2name",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_p2serial",
            "label": "Fortinet VPN IPSEC p2serial",
            "description": "Fortinet VPN IPSEC p2serial",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_index",
            "label": "Fortinet VPN SSL index",
            "description": "Fortinet VPN SSL index",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_eip",
            "label": "Fortinet VPN External IP",
            "description": "Fortinet VPN External IP",
            "type": "string",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        },
        {
            "tag": "connect_fvpn_poll",
            "label": "Fortinet VPN Last Poll Time",
            "description": "Fortinet VPN Last Poll Time",
            "type": "date",
            "group": "connect_fvpn_fvpn",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": "true",
                    "redo_change": "true"
                }
            ]
        }
    ],
    "action_groups": [
        {
            "name": "connect_fvpn_actions",
            "label": "Fortinet VPN"
        }
    ],
    "actions": [
        {
            "name": "connect_fvpn_disable_local_user",
            "label": "Disable Local User",
            "group": "connect_fvpn_actions",
            "description": "Disable Fortinet Local User",
            "ip_required": "true",
            "threshold_percentage": 1,
            "dependencies": [
                {
                    "name": "connect_fvpn_user",
                    "redo_new": "true",
                    "redo_change": "true"
                },
                {
                    "name": "connect_fvpn_ip"
                },
                {
                    "name": "connect_fvpn_learnt"
                },
                {
                    "name": "connect_fvpn_vdom"
                }
            ],
            "undo": {
                "label": "Cancel Disable Local User",
                "description": "Cancel Disable Fortinet Local User"
            }
        },
        {
            "name": "connect_fvpn_vpn_down",
            "label": "Drop VPN",
            "group": "connect_fvpn_actions",
            "description": "Down IPSec VPN / Terminate SSL VPN",
            "ip_required": "true",
            "threshold_percentage": 1,
            "dependencies": [
                {
                    "name": "connect_fvpn_type"
                },
                {
                    "name": "connect_fvpn_ip"
                },
                {
                    "name": "connect_fvpn_p1name"
                },
                {
                    "name": "connect_fvpn_p2name"
                },
                {
                    "name": "connect_fvpn_p2serial"
                },
                {
                    "name": "connect_fvpn_serial"
                },
                {
                    "name": "connect_fvpn_vdom"
                },
                {
                    "name": "connect_fvpn_index"
                },
                {
                    "name": "connect_fvpn_learnt"
                }
            ]
        }
    ],
    "scripts": [
        {
            "name": "fvpn_poll.py",
            "discovery": "true"
        },
        {
            "name": "fvpn_test.py",
            "test": "true"
        },
        {
            "name": "fvpn_disable_user.py",
            "actions": [
                "connect_fvpn_disable_local_user"
            ]
        },
        {
            "name": "fvpn_enable_user.py",
            "is_cancel": "true",
            "actions": [
                "connect_fvpn_disable_local_user"
            ]
        },
        {
            "name": "fvpn_vpn_down.py",
            "actions": [
                "connect_fvpn_vpn_down"
            ]
        }
    ],
    "policy_template": {
        "policy_template_group": {
            "name": "connect_fvpn",
            "label": "Fortinet VPN",
            "display": "Fortinet VPN Policy Group",
            "description": "Fortinet VPN Templates",
            "full_description": "<html>Use Fortinet VPN policy templates to control devices in a Fortinet VPN environment:<ul><li>Disable non-compliant Fortinet VPN devices.</li></ul></html>",
            "title_image": "connect_fvpn.png"
        },
        "policies": [
            {
                "name": "connect_fvpn_policy",
                "label": "Fortinet VPN disable non-compliant device",
                "display": "Fortinet VPN disable non-compliant device",
                "help": "Fortinet VPN Policy",
                "description": "Creates Fortinet VPN Policies",
                "file_name": "fvpn.xml",
                "full_description": "<html>Use this policy template to disable non-compliant Fortinet VPN users.</html>",
                "title_image": "connect_fvpn.png"
            }
        ]
    }
}